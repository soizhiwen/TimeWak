# [NeurIPS 2025 Spotlight] TimeWak: Temporal Chained-Hashing Watermark for Time Series Data

<div align="center">
    <a href="https://arxiv.org/pdf/2506.06407"><img src="https://img.shields.io/badge/Paper-arXiv-red" alt="paper"></a>
    <a href="https://huggingface.co/soizhiwen/TimeWak"><img src="https://img.shields.io/badge/Hugging%20Face-Model-yellow" alt="Hugging Face"></a>
    <a href="https://huggingface.co/datasets/soizhiwen/TimeWak"><img src="https://img.shields.io/badge/Hugging%20Face-Dataset-yellow" alt="Hugging Face"></a>
    <a href="https://github.com/soizhiwen/TimeWak"><img src="https://img.shields.io/badge/Platform-Linux-lightgrey" alt="version"></a>
    <a href="https://github.com/soizhiwen/TimeWak"><img src="https://img.shields.io/badge/Python-3.10-orange" alt="version"></a>
    <a href="https://github.com/soizhiwen/TimeWak"><img src="https://img.shields.io/badge/PyTorch-2.3-brightgreen" alt="python"></a>
    <a href="https://github.com/soizhiwen/TimeWak"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="mit"></a>
</div>

## TimeWak

### Abstract
Synthetic time series generated by diffusion models enable sharing privacy-sensitive datasets, such as patients' functional MRI records. Key criteria for synthetic data include high data utility and traceability to verify the data source. Recent watermarking methods embed in homogeneous latent spaces, but state-of-the-art time series generators operate in data space, making latent-based watermarking incompatible. This creates the challenge of watermarking directly in data space while handling feature heterogeneity and temporal dependencies. We propose TimeWak, the first watermarking algorithm for multivariate time series diffusion models. To handle temporal dependence and spatial heterogeneity, TimeWak embeds a temporal chained-hashing watermark directly within the temporal-feature data space. The other unique feature is the $\epsilon$-exact inversion, which addresses the non-uniform reconstruction error distribution across features from inverting the diffusion process to detect watermarks. We derive the error bound of inverting multivariate time series while preserving robust watermark detectability. We extensively evaluate TimeWak on its impact on synthetic data quality, watermark detectability, and robustness under various post-editing attacks, against five datasets and baselines of different temporal lengths. Our results show that TimeWak achieves improvements of 61.96% in context-FID score, and 8.44% in correlational scores against the strongest state-of-the-art baseline, while remaining consistently detectable.

### Overview

<div align="center">
  <img width="100%" src="./assets/TimeWak.svg">
</div>

First, we assign random seeds at the beginning of each interval. **1** Temporally chained-hashing. A, B, and C (pink) show seeds being copied from the previous step and the feature order shuffled. **2** Shuffling the seeds for each series. Positional indices are highlighted in green. **3** Constructing an initial Gaussian noise. **4** Generating multivariate time series. **5** Reversing the diffusion process. **6** Recovering the watermark seed. **7** Unshuffling the seeds in the opposite way they were shuffled. **8** Bit accuracy between the hash and recovered seed.

## Install
**Clone and Install**

```shell
git clone https://github.com/soizhiwen/TimeWak.git
cd TimeWak/
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

**Download Models and Datasets**

```shell
python download.py
```

## Usage
**Full Experiment**

```shell
bash run.sh
```

**Single Experiment**

Modify the configurations in [run.sh](run.sh), e.g.:
```shell
CONFIGS=("stocks")
METHODS=("timewak")
WINDOW_SIZES=(24)
ATTACKS=("offset")
OFFSET_FACTORS=(0.3)
```

**Evaluation**

- Context-FID and Correlational scores: [Experiments/metric_pytorch.ipynb](Experiments/metric_pytorch.ipynb)
- Discriminative and Predictive scores: [Experiments/metric_tensorflow.ipynb](Experiments/metric_tensorflow.ipynb)
- Z-score and TPR@0.1%FPR: [Experiments/metric_detection.ipynb](Experiments/metric_detection.ipynb)
- MDD, ACD, SD and KD: [Experiments/metric_ts.ipynb](Experiments/metric_ts.ipynb)

## Citation
```bibtex
@inproceedings{soi2025timewak,
  title        = {TimeWak: Temporal Chained-Hashing Watermark for Time Series Data},
  author       = {Zhi Wen Soi and Chaoyi Zhu and Fouad Abiad and Aditya Shankar and Jeroen M. Galjaard and Huijuan Wang and Lydia Y. Chen},
  booktitle    = {NeurIPS},
  year         = {2025},
}
```